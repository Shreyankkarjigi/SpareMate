{% extends 'layout.html' %}
{% block body %}
{% include '_messages.html'%}
<style>
   
   
    td,th{
        color: #e5e4e2;
    }
    body{
        font-family: Arial, Helvetica, sans-serif;
    }

    .tx{
        font-size:16px;
    }
    .tx1{
        font-size:16px;
    }
    .clearcart{
        float:right;
    }
    h5{
        color: #e5e4e2;
    }
</style>
<body>
<br>
<br>
<br>

<h1 class="text-center"><font color="#e5e4e2">Your Cart <i class="fa fa-shopping-cart" style="font-size:36px"></i></h1></font>
<br>
<div class="container">
    <h5>Product quanity is limited to 10 per product </h5>
<br>
    <div class="row"style="background-color:#0f0f0f;border-radius: 10;">
     
        <table class="table table-sm">
            <thead>
                <th>Sr</th>
                <th>Image</th>
                <th>Name</th>
                <th>Color</th>
                <th>Price</th>
                <th>Availability</th>
                <th>Quantity</th>
                <th>Discount</th>
                <th>Subtotal</th>
                <th>Update</th>
                <th>Delete</th>

            
            </thead>
            <tbody>
                {% for key,product in session['Shoppingcart'].items() %}
                {% set discount ="%0.2f"|format((product.discount/100)*product.price|float) %}
                <tr>
                <td>{{loop.index}}</td>
                <td><img src="{{url_for('static',filename='images/'+product.image)}}" alt="{{[product.name]}}" width="70",height="45"></td>
                <td>{{product.name}}</td>
                <br>
                <form action="{{url_for('updatecart',code=key)}}" method="POST">
                <td>
                    {% set colors=product.colors.split(',') %}
                    <select name="color" id="color">
                        <option value="{{product.color}}" style="display: none;">{{product.colors|capitalize}}</option>
                        {% for color in colors %}
                        {% set col= color.split(':') %}
                        <option value="{{col[0]}}">{{col[0]|capitalize}}</option>
                        {% endfor %}
                    </select>
                </td>
                <br>
                <td>&#8377;{{product.price}}</td>
                <br>
                {% if product.stock>0 %}
                <td><font color="green">In stock</font></td>
                {% else%}
                <td><font color="red">Out of stock</font></td>
                {% endif %}
                <form action="" method="POST">
                <td><input type="number" name="quantity" min="1" max="10" value="{{product.quantity}}"></td>
                <br>
                {% if product.discount>0 %}
                <td>{{product.discount}}%</td>
                {%else%}
                <td>NA</td>
                {% endif %}
                <!--sub total calculation with GST-->
                {% set subtotal=product.quantity|int*product.price|float %}
                <td>{{"%0.2f"|format((subtotal|float)-discount|float)}}</td>

                <td><button class="btn btn-dark" type="submit">Update</td></button>
                </form>
                <td><a href="{{url_for('deleteitem',id=key)}}" class="btn btn-danger">Delete</td></a>
                </tr>
                {% endfor %}
                <br>
                <tr>
                <br>
                <td></td>
                <br>
                <br>
                 <td class="tx"><b>Tax:&#8377;{{tax}}</td></b>
                 <td colspan="3" class="tx1"><b>Grand Total:&#8377;{{grandtotal}}</td></b>
                 <td colspan="3"><b>In words:{{to_words}}</b></td>
                </tr>
            </tbody>
        </table>
        <a href="{{url_for('get_order')}}"class="btn btn-outline-success">Order Now</a>
        <a href="/product_page"class="btn btn-outline-secondary">Continue shopping</a>
        <a href="/empty"class="btn btn-outline-danger ">Empty entire cart</a>
    </div>

</div>
<hr color="#e5e4e2">
{% endblock %}
